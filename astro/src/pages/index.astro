---
import Layout from '../layouts/Layout.astro';
import Header from '../components/layout/Header/Header.astro';
import Hero from '../components/sections/Hero/Hero.astro';
import Services from '../components/sections/Services/Services.astro';
import Stats from '../components/sections/Stats/Stats.astro';
import CaseStudies from '../components/sections/CaseStudies/CaseStudies.astro';
import Technologies from '../components/sections/Technologies/Technologies.astro';
import Testimonials from '../components/sections/Testimonials/Testimonials.astro';
import StartProjects from '../components/sections/StartProjects/StartProjects.astro';
import ContactUs from '../components/sections/ContactUs/ContactUs.astro';
import Footer from '../components/layout/Footer/Footer.astro';
import {
	getCaseStudies,
	getContactUs,
	getServices,
	getSiteSettings,
	getStartProjects,
	getStats,
	getTechnologies,
	getTestimonials
} from '../lib/cms.repository';
import wzxLogo from '../assets/wzx-logo.png';
import type {ImageMetadata} from "astro";

// Fix internal error response in local environment running preview
const imageMetadataLogo = (wzxLogo as ImageMetadata);
const wzxLogoFixed = {
	src: imageMetadataLogo.src.replace('@fs/', ''),
	width: imageMetadataLogo.width,
	height: imageMetadataLogo.height,
	format: imageMetadataLogo.format,
} as ImageMetadata;

const settings = await getSiteSettings();
const services = await getServices();
const stats = await getStats();
const caseStudies = await getCaseStudies();
const technologies = await getTechnologies();
const testimonials = await getTestimonials();
const startProjects = await getStartProjects();
const contactUs = await getContactUs();
---

<Layout
	title={settings.siteTitle}
	description={settings.siteDescription}
>
	<Header
		siteName={settings.siteName}
		logo={wzxLogoFixed}
		links={settings.header.links}
	/>
	<Hero />
	<Services
		title={services.title}
		description={services.description}
		items={services.items}
	/>
	<Stats
		title={stats.title}
		items={stats.items}
	/>
	<CaseStudies
		title={caseStudies.title}
		description={caseStudies.description}
		items={caseStudies.items}
	/>
	<Technologies
		title={technologies.title}
		items={technologies.items}
	/>
	<Testimonials
		title={testimonials.title}
		items={testimonials.items}
	/>
	<StartProjects
		title={startProjects.title}
		description={startProjects.description}
		actions={startProjects.actions}
	/>
	<ContactUs
		title={contactUs.title}
		description={contactUs.description}
		form={contactUs.form}
	/>
	<Footer
		copyright={settings.footer.copyright}
		links={settings.footer.links}
	/>
</Layout>